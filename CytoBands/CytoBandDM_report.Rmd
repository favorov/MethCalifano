Which cytobands are differentially methylated in the 2014-02-06_RO1_Batch1-4_ClinicalData_DeID data?
========================================================

Alexander Favorov  
-----------------------------------------------

### `r format(Sys.Date(), "%d %b %Y")` 

`r opts_chunk$set(echo=F,message=F,cache=F,warning=F)`
<!-- cache is off, we save all the neccessary things in Rda -->

We load the cytoband list (karyotype) from <a href=http://genome.ucsc.edu/>UCSC</a> DAS server and we load our MACS as described in <a href=..\2014-02-06_RO1_Batch1-4_ClinicalData_DeID.html>2014-02-06_RO1_Batch1-4_ClinicalData_DeID.xls.csv</a> file. 

Then, for each cytoband we calculate the net length of methylated regions (we read them from to MACS bedfiles) that ovelap with the cytoband in each of the samples.

```{r load and calculate}
options(width=100)
source('CytoBandDM.R')
columns<-c('id','space','start','end')
karyotype.stat<-cbind(karyotype.with.methylation[,columns],'p.value'=wilcoxon.p.values,'bonferroni'=wilcoxon.p.values.bonferroni,'fdr'=wilcoxon.p.values.fdr,'is.hyper'=normals.are.less.methylated)
```

Thus, for each interval (cytodand) we have a methylated length (coverage) for each sample).
Then, we calculate the Wilcoxon p-value for each cytoband's tumor and normal DM coverages.
We think that a cytoband is differentyally methylated if the p-value is <=0.05. 

### Here is the list of all differentially methylated cytobands, no multiple test correction

```{r print, no Bonferroni} 
print(karyotype.stat[DM.cytobands,])
```

### Here is the same list with Benjamini-Hoochberg correction
```{r print, with FDR} 
print(karyotype.stat[DM.cytobands.fdr,c(columns,'p.value','fdr','is.hyper')])
```

### And, here is the same list with Bonferroni correction
```{r print, with Bonferroni} 
print(karyotype.stat[DM.cytobands.bonferroni,c(columns,'p.value','bonferroni','is.hyper')])
```
As far as only one cytoband pass the correction, FDR and Bonferroni are the same. The fdr for the second one is `r wilcoxon.p.values.fdr[order(wilcoxon.p.values.fdr)[2]]` and it is too high. 

Technical info
-------------------------------
Clinical data file: `r clinFile`.

Its size and modification time: 
```{r file.info}
file.info(clinFile)[,c('size','mtime')] 
```
Number of records is `r nrow(Clinical)`

Bed files:
```{r bed files}
beds
```
DNAIds not in beds:
```{r not in beds}
DNAids[!bed_available]
```
Beds no in DNAids:
```{r not in DNAids}
beds[!bed_used]
```

